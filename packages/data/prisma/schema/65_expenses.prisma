model Expense {
  id             String         @id @default(cuid())
  tenantId       String
  status         ExpenseStatus  @default(DRAFT)
  expenseDate    DateTime       @db.Date
  merchantName   String?
  supplierPartyId String?
  currency       String            @db.VarChar(3)
  notes          String?
  category       String?
  totalAmountCents Int
  taxAmountCents Int?
  archivedAt     DateTime?      @db.Timestamptz(6)
  archivedByUserId String?
  createdByUserId String?
  custom         Json?
  createdAt      DateTime       @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime       @updatedAt @db.Timestamptz(6)

  lines ExpenseLine[]

  @@index([tenantId])
  @@index([tenantId, expenseDate])
  @@index([tenantId, status])
  @@index([tenantId, archivedAt])
  @@schema("billing")
}

model ExpenseLine {
  id             String        @id @default(cuid())
  tenantId       String
  expenseId      String
  description    String
  quantity       Int           @default(1)
  unitPriceCents Int
  lineTotalCents Int
  taxRate        Float?
  category       String?
  createdAt      DateTime      @default(now()) @db.Timestamptz(6)

  expense Expense @relation(fields: [expenseId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([expenseId])
  @@schema("billing")
}

enum ExpenseStatus {
  DRAFT
  SUBMITTED
  APPROVED
  REJECTED
  PAID
  @@schema("billing")
}
